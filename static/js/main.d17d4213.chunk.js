(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{298:function(e,t,n){},299:function(e,t,n){},304:function(e,t){},305:function(e,t){},313:function(e,t){},320:function(e,t,n){"use strict";n.r(t);var i,a,c,o,r,s,l,u,d,f,h,p,v,j,b,g,m,y,O,w,x,k,D,P,S,C,A,I,E=n(4),F=n.n(E),B=n(59),L=n.n(B),M=(n(298),n(8)),N=n(142),T=(n(299),n(9)),q=n.n(T),J=n(13),K=n(289),R=(n(319),n(323)),z=n(51),G=void 0,H=function(e){var t=e.setPaused,n=Object(E.useState)(!1),a=Object(M.a)(n,2),c=a[0],o=a[1],r=Object(E.useState)(!1),s=Object(M.a)(r,2),l=s[0],u=s[1],d=function(e){e?o(!0):u(!0)},f=function(){X(d),V(),t(!0),o(!1),u(!1)};return Object(E.useEffect)((function(){var e=!1;function t(){return(t=Object(J.a)(q.a.mark((function t(){var n,a;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("start"),t.next=3,Object(K.a)();case 3:n=t.sent,(a=document.getElementById("video")).setAttribute("playsinline","true"),navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}).then((function(e){a.srcObject=e,a.play()})).catch((function(e){console.log("An error occurred: "+e),alert("not supported")})),a.addEventListener("canplay",(function(t){e||(console.log("canplay"),e=!0,i=function(){var e=Object(J.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.estimateSinglePose(a,{flipHorizontal:!0});case 2:return G=e.sent,console.log(G),e.abrupt("return",G);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X(d),ee())}),!1);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}window.addEventListener("load",(function(){return t.apply(this,arguments)}),!1)}),[]),Object(z.jsxs)("div",{className:"game",children:[Object(z.jsx)("div",{className:"camera",children:Object(z.jsx)("video",{id:"video",width:"240",style:{transform:"scaleX(-1)"},children:"Video stream not available."})}),Object(z.jsx)("canvas",{id:"myCanvas",width:"480",height:"320"}),Object(z.jsx)(R.a,{className:"succeed",visible:c,onCancel:function(){o(!1)},onOk:f,footer:Object(z.jsx)(N.a,{onClick:f,children:"OK"}),children:"\u83b7\u80dc"}),Object(z.jsx)(R.a,{className:"failed",visible:l,onCancel:function(){u(!1)},onOk:f,footer:Object(z.jsx)(N.a,{onClick:f,children:"OK"}),children:"\u5931\u8d25"})]})},U=n.p+"static/media/background.ce91d2ae.jpg",V=function(){I&&I.pause(),console.log(S),cancelAnimationFrame(S)},X=function(e){C=e,a=document.getElementById("myCanvas"),P=document.getElementById("video"),I||(I=new Audio("/BGM.mp3")),A||(A=new Audio("/hit.wav")),c=a.getContext("2d"),o=10,r=a.width/2,s=a.height-30,l=2,u=-2,d=10,f=75,h=(a.width-f)/2,p=!1,v=!1,j=5,b=3,g=75,m=20,y=10,w=30,O=30,x=0,k=3,D=[];for(var t=0;t<b;t++){D[t]=[];for(var n=0;n<j;n++)D[t][n]={x:0,y:0,status:1}}};function Q(){c.beginPath(),c.arc(r,s,o,0,2*Math.PI),c.fillStyle="#0095DD",c.fill(),c.closePath()}function W(){c.beginPath(),c.rect(h,a.height-d,f,d),c.fillStyle="#0095DD",c.fill(),c.closePath()}function Y(){for(var e=0;e<b;e++)for(var t=0;t<j;t++)if(1==D[e][t].status){var n=t*(g+y)+O,i=e*(m+y)+w;D[e][t].x=n,D[e][t].y=i,c.beginPath(),c.rect(n,i,g,m),c.fillStyle="#0095DD",c.fill(),c.closePath()}}function Z(){c.font="16px Arial",c.fillStyle="#0095DD",c.fillText("Score: "+x,8,20)}function $(){c.font="16px Arial",c.fillStyle="#0095DD",c.fillText("Lives: "+k,a.width-65,20)}var _=new Image;function ee(){c.clearRect(0,0,a.width,a.height),c.drawImage(_,0,0),Y(),Q(),W(),Z(),$()}function te(){c.clearRect(0,0,a.width,a.height),c.drawImage(_,0,0),Y(),Q(),W(),Z(),$(),function(){for(var e=0;e<b;e++)for(var t=0;t<j;t++){var n,i=D[e][t];1==i.status&&r>i.x&&r<i.x+g&&s>i.y&&s<i.y+m&&(u=-u,i.status=0,null===(n=A)||void 0===n||n.play(),++x==j*b&&C(!0))}}(),(r+l>a.width-o||r+l<o)&&(l=-l),s+u<o?u=-u:s+u>a.height-o&&(r>h&&r<h+f?u=-u:--k?(r=a.width/2,s=a.height-30,l=2,u=-2,h=(a.width-f)/2):C(!1)),p&&h<a.width-f?h+=7:v&&h>0&&(h-=7),r+=l,s+=u,i().then((function(e){e.keypoints[0].score>.6&&(h=e.keypoints[0].position.x/P.width*a.width*1.1)})),S=requestAnimationFrame(te)}_.src=U;n(318);var ne=function(){var e=Object(E.useState)(!0),t=Object(M.a)(e,2),n=t[0],i=t[1];return Object(z.jsxs)("div",{className:"App",children:[Object(z.jsx)(H,{setPaused:i}),Object(z.jsx)(N.a,{onClick:function(){n?(I&&(console.log(I),I.autoplay=!0,I.play()),requestAnimationFrame(te)):V(),i(!n)},children:n?"\u5f00\u59cb":"\u6682\u505c"})]})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,324)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),i(e),a(e),c(e),o(e)}))};L.a.render(Object(z.jsx)(F.a.StrictMode,{children:Object(z.jsx)(ne,{})}),document.getElementById("root")),ie()}},[[320,1,2]]]);
//# sourceMappingURL=main.d17d4213.chunk.js.map