(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{276:function(e,t,n){},277:function(e,t,n){},282:function(e,t){},283:function(e,t){},291:function(e,t){},298:function(e,t,n){"use strict";n.r(t);var a,c,i,s,o,r,l,u,d,h,f,p,g,b,j,v,m,O,x,w,y,A,k,I,C,N,S,P=n(4),_=n.n(P),E=n(57),F=n.n(E),B=(n(276),n(277),n(9)),D=n.n(B),M=n(13),L=n(8),T=n(268),K=(n(297),function(){S&&S.pause(),console.log(I),cancelAnimationFrame(I)}),q=function(e){C=e,a=document.getElementById("myCanvas"),k=document.getElementById("video"),S||(S=new Audio("/posenet_react/Assets/BGM.mp3")),N||(N=new Audio("/posenet_react/Assets/hit.wav")),c=a.getContext("2d"),i=10,s=a.width/2,o=a.height-30,r=2,l=-2,u=10,d=75,h=(a.width-d)/2,f=!1,p=!1,g=5,b=3,j=75,v=20,m=10,x=30,O=30,w=0,y=3,A=[];for(var t=0;t<b;t++){A[t]=[];for(var n=0;n<g;n++)A[t][n]={x:0,y:0,status:1}}},J=function(e){var t=new Image;return t.src=e,t};function R(){c.beginPath(),c.drawImage(J("/posenet_react/Assets/ball.png"),s-i,o-i),c.closePath()}function z(){c.beginPath(),c.drawImage(J("/posenet_react/Assets/paddle.png"),h,a.height-u,d,u),c.closePath()}function G(){for(var e=0;e<b;e++)for(var t=0;t<g;t++)if(1==A[e][t].status){var n=t*(j+m)+O,a=e*(v+m)+x;A[e][t].x=n,A[e][t].y=a,c.drawImage(J("/posenet_react/Assets/brick1.png"),n,a,j,v)}}function H(){c.font="16px Arial",c.fillStyle="#0095DD",c.fillText("Score: "+w,8,20)}function U(){c.font="16px Arial",c.fillStyle="#0095DD",c.fillText("Lives: "+y,a.width-65,20)}var X=new Image;function Q(){c.clearRect(0,0,a.width,a.height),c.drawImage(X,0,0),G(),R(),z(),H(),U()}function V(){c.clearRect(0,0,a.width,a.height),c.drawImage(X,0,0),G(),R(),z(),H(),U(),function(){for(var e=0;e<b;e++)for(var t=0;t<g;t++){var n,a=A[e][t];1==a.status&&s>a.x&&s<a.x+j&&o>a.y&&o<a.y+v&&(l=-l,a.status=0,null===(n=N)||void 0===n||n.play(),++w==g*b&&C(!0))}}(),(s+r>a.width-i||s+r<i)&&(r=-r),o+l<i?l=-l:o+l>a.height-i&&(Math.abs(s+10-(h+d/2))<(10+d)/2&&Math.abs(o+10-(a.height-u+u/2))<(10+u)/2?l=-l:0===--y?(y=0,C(!1)):(s=a.width/2,o=a.height-30,r=2,l=-2,h=(a.width-d)/2)),f&&h<a.width-d?h+=7:p&&h>0&&(h-=7),s+=r,o+=l,W().then((function(e){e.keypoints[0].score>.6&&(h=e.keypoints[0].position.x/k.width*a.width*1.1)})),I=requestAnimationFrame(V)}X.src="/posenet_react/Assets/background.jpg";var W,Y=n(302),Z=n(40),$=void 0,ee=function(){var e=Object(P.useState)(!0),t=Object(L.a)(e,2),n=t[0],a=t[1],c=Object(P.useState)(!1),i=Object(L.a)(c,2),s=i[0],o=i[1],r=Object(P.useState)(!1),l=Object(L.a)(r,2),u=l[0],d=l[1],h=function(e){e?o(!0):d(!0)},f=function(){q(h),K(),a(!0),o(!1),d(!1)};return Object(P.useEffect)((function(){var e=!1;function t(){return(t=Object(M.a)(D.a.mark((function t(){var n,a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("start"),t.next=3,Object(T.a)();case 3:n=t.sent,(a=document.getElementById("video")).setAttribute("playsinline","true"),navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}).then((function(e){a.srcObject=e,a.play()})).catch((function(e){console.log("An error occurred: "+e),alert("not supported")})),a.addEventListener("canplay",(function(t){e||(console.log("canplay"),e=!0,W=function(){var e=Object(M.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.estimateSinglePose(a,{flipHorizontal:!0});case 2:return $=e.sent,console.log($),e.abrupt("return",$);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q(h),Q())}),!1);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}window.addEventListener("load",(function(){return t.apply(this,arguments)}),!1)}),[]),Object(Z.jsxs)("div",{className:"main-screen",children:[Object(Z.jsx)("div",{className:"left"}),Object(Z.jsx)("div",{className:"header",children:Object(Z.jsx)("img",{src:"/posenet_react/Assets/title.png",width:"90%",height:"auto",alt:"PoseNet \u6253\u7816\u5757"})}),Object(Z.jsx)("canvas",{id:"myCanvas",width:"480",height:"320"}),Object(Z.jsxs)("div",{className:"controls",children:[Object(Z.jsx)("div",{className:"control-buttons",children:Object(Z.jsx)("button",{style:{backgroundColor:"lightgray",backgroundImage:"/posenet_react/Assets/OKbutton.png"},onClick:function(){n?(S&&(console.log(S),S.autoplay=!0,S.play()),requestAnimationFrame(V)):K(),a(!n)},children:n?"\u5f00\u59cb":"\u6682\u505c"})}),Object(Z.jsx)("div",{className:"camera",children:Object(Z.jsx)("video",{id:"video",width:"240",style:{transform:"scaleX(-1)"},children:"\u89c6\u9891\u6d41\u4e0d\u53ef\u7528\u3002"})})]}),Object(Z.jsx)("div",{className:"right"}),Object(Z.jsx)(Y.a,{className:"title",visible:s,onCancel:function(){o(!1)},onOk:f,footer:Object(Z.jsx)("button",{onClick:f,children:"OK"}),children:"\u83b7\u80dc"}),Object(Z.jsx)(Y.a,{className:"failed",visible:u,onCancel:function(){d(!1)},onOk:f,footer:Object(Z.jsx)("button",{onClick:f,children:"OK"}),children:"\u5931\u8d25"})]})};n(296);var te=function(){return Object(Z.jsx)("div",{className:"App",children:Object(Z.jsx)(ee,{})})},ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,303)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),i(e),s(e)}))};F.a.render(Object(Z.jsx)(_.a.StrictMode,{children:Object(Z.jsx)(te,{})}),document.getElementById("root")),ne()}},[[298,1,2]]]);
//# sourceMappingURL=main.5bf5cca1.chunk.js.map