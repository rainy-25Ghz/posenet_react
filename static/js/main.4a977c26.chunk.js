(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{297:function(e,t,n){},298:function(e,t,n){},303:function(e,t){},304:function(e,t){},312:function(e,t){},319:function(e,t,n){"use strict";n.r(t);var c,a,i,s,o,r,l,u,d,f,h,j,p,v,b,m,g,O,x,w,y,A,k,S,C,I,N,P=n(4),D=n.n(P),E=n(59),F=n.n(E),B=(n(297),n(8)),L=(n(298),n(9)),M=n.n(L),_=n(13),T=n(289),q=(n(318),function(){N&&N.pause(),console.log(S),cancelAnimationFrame(S)}),J=function(e){C=e,c=document.getElementById("myCanvas"),k=document.getElementById("video"),N||(N=new Audio("/posenet_react/Assets/BGM.mp3")),I||(I=new Audio("/posenet_react/Assets/hit.wav")),a=c.getContext("2d"),i=10,s=c.width/2,o=c.height-30,r=2,l=-2,u=10,d=75,f=(c.width-d)/2,h=!1,j=!1,p=5,v=3,b=75,m=20,g=10,x=30,O=30,w=0,y=3,A=[];for(var t=0;t<v;t++){A[t]=[];for(var n=0;n<p;n++)A[t][n]={x:0,y:0,status:1}}};function K(){a.beginPath(),a.arc(s,o,i,0,2*Math.PI),a.fillStyle="#0095DD",a.fill(),a.closePath()}function R(){a.beginPath(),a.rect(f,c.height-u,d,u),a.fillStyle="#0095DD",a.fill(),a.closePath()}function z(){for(var e=0;e<v;e++)for(var t=0;t<p;t++)if(1==A[e][t].status){var n=t*(b+g)+O,c=e*(m+g)+x;A[e][t].x=n,A[e][t].y=c;a.drawImage(function(e){var t=new Image;return t.src=e,t}("/posenet_react/Assets/brick1.png"),n,c,b,m)}}function G(){a.font="16px Arial",a.fillStyle="#0095DD",a.fillText("Score: "+w,8,20)}function H(){a.font="16px Arial",a.fillStyle="#0095DD",a.fillText("Lives: "+y,c.width-65,20)}var U=new Image;function X(){a.clearRect(0,0,c.width,c.height),a.drawImage(U,0,0),z(),K(),R(),G(),H()}function Q(){a.clearRect(0,0,c.width,c.height),a.drawImage(U,0,0),z(),K(),R(),G(),H(),function(){for(var e=0;e<v;e++)for(var t=0;t<p;t++){var n,c=A[e][t];1==c.status&&s>c.x&&s<c.x+b&&o>c.y&&o<c.y+m&&(l=-l,c.status=0,null===(n=I)||void 0===n||n.play(),++w==p*v&&C(!0))}}(),(s+r>c.width-i||s+r<i)&&(r=-r),o+l<i?l=-l:o+l>c.height-i&&(s>f&&s<f+d?l=-l:0===--y?(y=0,C(!1)):(s=c.width/2,o=c.height-30,r=2,l=-2,f=(c.width-d)/2)),h&&f<c.width-d?f+=7:j&&f>0&&(f-=7),s+=r,o+=l,V().then((function(e){e.keypoints[0].score>.6&&(f=e.keypoints[0].position.x/k.width*c.width*1.1)})),S=requestAnimationFrame(Q)}U.src="/posenet_react/Assets/background.jpg";var V,W=n(137),Y=n(323),Z=n(41),$=void 0,ee=function(e){var t=e.setPaused,n=Object(P.useState)(!1),c=Object(B.a)(n,2),a=c[0],i=c[1],s=Object(P.useState)(!1),o=Object(B.a)(s,2),r=o[0],l=o[1],u=function(e){e?i(!0):l(!0)},d=function(){J(u),q(),t(!0),i(!1),l(!1)};Object(P.useEffect)((function(){var e=!1;function t(){return(t=Object(_.a)(M.a.mark((function t(){var n,c;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("start"),t.next=3,Object(T.a)();case 3:n=t.sent,(c=document.getElementById("video")).setAttribute("playsinline","true"),navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}).then((function(e){c.srcObject=e,c.play()})).catch((function(e){console.log("An error occurred: "+e),alert("not supported")})),c.addEventListener("canplay",(function(t){e||(console.log("canplay"),e=!0,V=function(){var e=Object(_.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.estimateSinglePose(c,{flipHorizontal:!0});case 2:return $=e.sent,console.log($),e.abrupt("return",$);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J(u),X())}),!1);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}window.addEventListener("load",(function(){return t.apply(this,arguments)}),!1)}),[]);var f=Object(P.useState)(!0),h=Object(B.a)(f,2),j=h[0],p=h[1];return Object(Z.jsxs)("div",{className:"main-screen",children:[Object(Z.jsx)("div",{className:"left"}),Object(Z.jsx)("div",{className:"header",children:Object(Z.jsx)("img",{src:"/posenet_react/Assets/title.png",width:"430px",height:"auto",alt:"PoseNet \u6253\u7816\u5757"})}),Object(Z.jsx)("canvas",{id:"myCanvas",width:"480",height:"320"}),Object(Z.jsxs)("div",{className:"controls",children:[Object(Z.jsx)("div",{className:"camera",children:Object(Z.jsx)("video",{id:"video",width:"240",style:{transform:"scaleX(-1)"},children:"\u89c6\u9891\u6d41\u4e0d\u53ef\u7528\u3002"})}),Object(Z.jsx)("div",{className:"control-buttons",children:Object(Z.jsx)(W.a,{onClick:function(){j?(N&&(console.log(N),N.autoplay=!0,N.play()),requestAnimationFrame(Q)):q(),p(!j)},children:j?"\u5f00\u59cb":"\u6682\u505c"})})]}),Object(Z.jsx)("div",{className:"right"}),Object(Z.jsx)(Y.a,{className:"succeed",visible:a,onCancel:function(){i(!1)},onOk:d,footer:Object(Z.jsx)(W.a,{onClick:d,children:"OK"}),children:"\u83b7\u80dc"}),Object(Z.jsx)(Y.a,{className:"failed",visible:r,onCancel:function(){l(!1)},onOk:d,footer:Object(Z.jsx)(W.a,{onClick:d,children:"OK"}),children:"\u5931\u8d25"})]})};n(317);var te=function(){var e=Object(P.useState)(!0),t=Object(B.a)(e,2),n=(t[0],t[1]);return Object(Z.jsx)("div",{className:"App",children:Object(Z.jsx)(ee,{setPaused:n})})},ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,324)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};F.a.render(Object(Z.jsx)(D.a.StrictMode,{children:Object(Z.jsx)(te,{})}),document.getElementById("root")),ne()}},[[319,1,2]]]);
//# sourceMappingURL=main.4a977c26.chunk.js.map